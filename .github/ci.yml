name: Web Project CI

on:
  push:
    branches:
      - main
  pull_request:
    branches:
      - main

jobs:
  validate:
    name: Validate Code
    runs-on: ubuntu-latest

    steps:
    - name: Checkout code
      uses: actions/checkout@v3  # Clona el repositorio

    # Validar HTML
    - name: Validate HTML
      uses: chris48s/action-html-proofer@v0.1.0
      with:
        directory: "./"  # Ruta del proyecto

    # Validar JavaScript (Linting)
    - name: Validate JavaScript
      run: |
        npm install eslint --global
        eslint ./js/*.js

    # Validar PHP
    - name: Validate PHP
      run: |
        sudo apt-get install php-cli -y
        php -l ./php/*.php  # Revisa errores de sintaxis en los archivos PHP

  build:
    name: Build and Test
    runs-on: ubuntu-latest

    steps:
    - name: Checkout code
      uses: actions/checkout@v3

    # Configurar servidor PHP para pruebas locales
    - name: Start PHP Server
      run: |
        php -S localhost:8000 -t ./  # Inicia un servidor PHP en localhost
        sleep 5  # Espera a que el servidor est√© listo

    # Probar acceso al servidor
    - name: Test PHP Server
      run: curl http://localhost:8000/index.php
